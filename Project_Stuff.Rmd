---
title: "Project Stuff"
author: "Owen Wright"
date: "11/15/2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(igraph)
library(rgl)
```

#activities imports, adding names as a column to aid in our kudos network
```{r}
Elliot_run<-read_csv("Elliot/activities.csv")%>% #Elliot's data messing
  filter(type=="Run",
         date>"2018-6-01")%>%
  mutate(miles=distance/1609,
         minutes=elapsed_time/60,
         pace=minutes/miles)%>%
  select(-type, -gear, -commute)%>%
  mutate(person="ell",
         count=131)

Justin_run<-read_csv("Fursnatch/activities.csv")%>% #Justin's data messing
  filter(type=="Run",
         date>"2018-6-01")%>%
  mutate(miles=distance/1609,
         minutes=elapsed_time/60,
         pace=minutes/miles)%>%
  select(-type, -gear, -commute)%>%
  mutate(person="justin",
         count=936)
Mowgli_run<-read_csv("Mowgli/activities.csv")%>% 
  filter(type=="Run",
         date>"2018-6-01")%>%
  mutate(miles=distance/1609,
         minutes=elapsed_time/60,
         pace=minutes/miles)%>%
  select(-type, -gear, -commute)%>%
  mutate(person="mowg",
         count=335)
Birdo_run<-read_csv("Birdo/activities.csv")%>%
  filter(type=="Run",
         date>"2018-6-01")%>%
  mutate(miles=distance/1609,
         minutes=elapsed_time/60,
         pace=minutes/miles)%>%
  select(-type, -gear, -commute)%>%
  mutate(person="birdo",
         count=642)

Jackson <- read_csv("Jackson/activities.csv")
Jackson_run<-Jackson%>%
  filter(type=="Run",
         date>"2018-6-01")%>%
  mutate(miles=distance/1609,
         minutes=elapsed_time/60,
         pace=minutes/miles)%>%
  select(-type,-gear, -commute)%>%
  mutate(person="jack",
         count=531)
Finn_run<-read_csv("Finn/Finn/activities.csv")%>%
  filter(type=="Run",
         date>"2018-6-01")%>%
  mutate(miles=distance/1609,
         minutes=elapsed_time/60,
         pace=minutes/miles)%>%
  select(-type,-gear, -commute)%>%
  mutate(person="finn",
         count=370)
Plumb_run<-read_csv("Plumb/activities.csv")%>%
  filter(type=="Run",
         date>"2018-6-01")%>%
  mutate(miles=distance/1609,
         minutes=elapsed_time/60,
         pace=minutes/miles)%>%
  select(-type,-gear, -commute)%>%
  mutate(person="plumb",
         count=761)

all_activities<-Elliot_run%>%
  rbind(Justin_run, Birdo_run, Mowgli_run, Jackson_run, Finn_run, Plumb_run)%>%
  select(-filename)


```
#Kudos imports, adding column with name to create network
```{r}
Finn_kudos<- read_csv("Finn/Finn/kudos.csv")%>%
  mutate(giver="finn")
Justin_kudos<- read_csv("Fursnatch/kudos.csv")%>%
  mutate(giver="justin")
Jackson_kudos<- read_csv("Jackson/kudos.csv")%>%
  mutate(giver="jack")
Mowgli_kudos<- read_csv("Mowgli/kudos.csv")%>%
  mutate(giver="mowg")
Plumb_kudos<- read_csv("Plumb/kudos.csv")%>%
  mutate(giver="plumb")
all_kudos<-Finn_kudos%>%
  rbind(Justin_kudos, Jackson_kudos, Mowgli_kudos, Plumb_kudos)

#merging all activities and kudos 
#then we can mess around with grouping to create our network
network<-all_kudos%>%
  inner_join(all_activities, by="id")%>%
  select(giver, person, elapsed_time, distance, miles, minutes, pace, name, description, count)%>%
  group_by(giver, person)%>%
  summarise(number=n())%>%
  spread(person, number, drop=FALSE, fill=0)%>%
  ungroup()%>%
  select(-birdo, -ell,-giver)
net_matrix<-as.matrix(network)

g<-graph.adjacency(net_matrix, mode="direct", weighted=NULL)


df <- function(giver, taker){
  giver %>%
    inner_join(taker, by="id") %>%
    count()
  
}



g<-graph.adjacency(net_matrix, mode="direct", weighted=NULL)

plot.igraph(g, edge.arrow.size=.5, vertex.size = 15)
#igraph_options(plot.layout=layout.lgl)

layout <- layout.reingold.tilford(g, circular=T)
 plot(g, layout=layout)
```

